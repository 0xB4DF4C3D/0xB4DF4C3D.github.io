---
layout: "post"
title: "[심화DB] 1차 정규화"
date: "2018-03-11 14:21"
category: TOPCIT
---

# 1차 정규화 이론
1차 정규화 이론이랑 **정규화의 출발점** 으로써 **파일시스템으로부터 중복성을 제거** 한다. 이를 통해 안정적인 데이터 처리 구조를 구축이며 프로젝트 현장에서도 자주 접하는 현상이다.

# 학습 목표
0. **1차 정규화의 정의** 와 **핵심 특징**을 설명할 수 있다.
1. **1차 정규화가 성립되기 위한 방법** 을 설명할 수 있다.
2. 실제 사례를 통해 **1차 정규화를 수행** 할 수 있다.

# 사전 준비

0. `1차 정규화`는 '어떤 릴레이션 R에 속한 모든 도메인이 원자 값(Atomic Value)을 구성함'을 의미한다.
1. 정규화 되지 않은 상태에서 데이터를 입력, 수정, 삭제할 때 정상적으로 처리되지 않고 불필요한 값을 입력하거나 삭제 또는 많은 수의 레코드를 수정해야 하는 `이상현상`이 발생한다.
2. 1차 정규화는 `결정자(PK)`를 무엇으로 선정하였는지가 중요하다.
3. 1차 정규화를 수행하는 방법으로는 결정자를 `복합속성`으로 지정하는 방법과 반복되는 속성들에 대해서 별도의 테이블로 분리하여 수행하는 방법이 있다.

# 01. 1차 정규화의 개요

## 1차 정규화

어떤 릴레이션 R에 속한 모든 도메인이 **원자 값(Atomic Value)** 을 구성함.

`원자 값(Atomic Value)을 유지하지 않은 데이터 집합` -> 반복 또는 중복 속성

## 1차 정규화의 대상

주식별자(Primary Key)로서 개별 레코드를 식별할 수 없는 상태
<br>
-> **레코드 단위로 중복** 되어 있는 경우

**컬럼을 여러개로 하여 중복성** 을 펼칠 경우
<br>
-> 주식별자(Primary Key)에 대한 테이블 생성 가능

## 1차 정규화의 특징

**결정자(PK)** 가 무엇인가?
<br>
테이블의 결정자는 무엇인가? -> 밑줄이 그어진 상태의 값
<br>
`중복?` `반복?` `원자성 확보?` -> 판단 가능

**결정자(PK)를 무엇으로 선정하였는가?**
<br>
결정자 하나에 **대응되는 종속자 레코드가 1개** 인가?
그렇다면 이를 `원자성(Atomic Value)`라 함.
<br>
주식별자 1개에 대해 **반복 그룹(2개 이상)이 존재하면 1차 정규화의 대상!**

# 02. 1차 정규화의 `유형`

## 1차 정규화의 대상 테이블

<table style="text-align:center;">
  <tr>
    <th><u>제품번호</u></th>
    <th>제품명</th>
    <th>주문번호</th>
    <th>주문수량</th>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101001</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101002</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101003</td>
    <td>2</td>
  </tr>
</table>

`주식별자`는 _제품번호_(밑줄 쳐져 있어서), `일반 속성`은 _나머지들_ 이다. `주식별자`는 `결정자`라고 얘기하며 _나머지들_ 을 `종속자`라고 함. `결정자`가 `종속자`를 결정해주는 성향을 `함수적 종속성`이라고 얘기함

<table style="text-align:center;">
  <tr>
    <th>제품번호</th>
    <th>제품명</th>
    <th>주문번호</th>
    <th>주문수량</th>
  </tr>
  <tr>
    <td rowspan="3">1001</td>
    <td rowspan="3">컴퓨터</td>
    <td>20040101001</td>
    <td>1</td>
  </tr>
  <tr>
    <td>20040101002</td>
    <td>1</td>
  </tr>
  <tr>
    <td>20040101003</td>
    <td>2</td>
  </tr>
</table>

제품번호 1개에 대해서 주문번호와 주문수량은? -> **2개 이상** -> **원자속성(Atomic Value)이 아님** -> **1차 정규화의 대상**

## 1차 정규화를 하지 않았을 때의 이상현상

<table style="text-align:center;">
  <tr>
    <th><u>제품번호</u></th>
    <th>제품명</th>
    <th>주문번호</th>
    <th>주문수량</th>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101001</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101002</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101003</td>
    <td>2</td>
  </tr>
</table>

1차 정규화를 하지 않았을때 나타나는 이상현상(Anomaly)에는
`입력 이상`, `수정 이상`, `삭제 이상` 이 있다.
- 입력 이상 : 주문에 대한 정보만 입력해도 제품에 대한 정보를 입력해야 함.
- 수정 이상 : 동일한 제품명을 **중복되어 있는 수만큼 수정** 해야 함, 한번만 수정하거나 **일부만 수정할 경우 일관성이 맞지 않는 문제** 발생
- 삭제 이상 : 주문에 대한 정보(주문번호, 주문수량)을 삭제하려면 제품번호와 제품명을 삭제해야 함, 동일한 레코드에 있으므로 1건의 레코드가 삭제됨.

## 1차 정규화 수행 방법

<table style="text-align:center;">
  <tr>
    <th><u>제품번호</u></th>
    <th>제품명</th>
    <th>주문번호</th>
    <th>주문수량</th>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101001</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101002</td>
    <td>1</td>
  </tr>
  <tr>
    <td>1001</td>
    <td>컴퓨터</td>
    <td>20040101003</td>
    <td>2</td>
  </tr>
</table>

1. **결정자를 복합속성으로 지정** 하는 방법
2. **반복되는 속성들을 별도의 테이블로 분리** 하여 수행

두 방법 다 핵심은 **원자속성(Atomic Value) 확보**

# 03. 1차 정규화 `사례`

## 고객 테이블 - 예시

<table style="text-align:center;">
  <tr>
    <th><u>고객번호</u></th>
    <th>고객명</th>
    <th>취미코드</th>
    <th>취미명</th>
  </tr>
  <tr>
    <td>1</td>
    <td>홍길동</td>
    <td>01, 02</td>
    <td>영화, 바둑</td>
  </tr>
  <tr>
    <td>2</td>
    <td>임꺽정</td>
    <td>03</td>
    <td>독서</td>
  </tr>
  <tr>
    <td>3</td>
    <td>이순신</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
  <tr>
    <td>주식별자</td>
    <td colspan="3">종속자</td>
  </tr>
</table>

취미 코드는 다음과 같다<br>
```
01 영화
02 바둑
03 독서
```

홍길동은 취미가 2개이상 이다. -> 속성 값에 대한 원자성(Atomic Value)을 확보하지 않음 -> 1차 정규화의 대상

주식별자(결정자) 판단 -> 대응 레코드가 1개 또는 2개인지 판단 -> 2개 이상일 경우 원자성에 위배 -> 1차 정규화의 대상

취미에 대한 정보를 입력하려 할 때도 항상 고객정보를 입력해야 함 -> `입력 이상`

한번만 수정하면 안되고 취미를 가진 모든 사람에 대해서 수정해야 함 -> `수정 이상`

취미 정보만 삭제할 때, 고객 정보까지 같이 삭제가 되야 함 -> `삭제 이상`

**해결법**
- 테이블 내에서 결정자를 복합속성으로 지정하는 방법
- 2개의 테이블로 분리하는 방법

**테이블 내에서 결정자를 복합속성으로 지정하는 방법**

<table style="text-align:center;">
  <tr>
    <th><u>고객번호</u></th>
    <th>고객명</th>
  </tr>
  <tr>
    <td>1</td>
    <td>홍길동</td>
  </tr>
  <tr>
    <td>2</td>
    <td>임꺽정</td>
  </tr>
  <tr>
    <td>3</td>
    <td>이순신</td>
  </tr>
</table>
테이블 A
<br><br><br>
<table style="text-align:center;">
  <tr>
    <th><u>고객번호</u></th>
    <th><u>취미코드</u></th>
    <th>취미명</th>
  </tr>
  <tr>
    <td>1</td>
    <td>01</td>
    <td>영화</td>
  </tr>
  <tr>
    <td>1</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
  <tr>
    <td>2</td>
    <td>03</td>
    <td>독서</td>
  </tr>
  <tr>
    <td>3</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
</table>
테이블 B

**2개의 테이블로 분리하는 방법**

<table style="text-align:center;">
  <tr>
    <th><u>고객번호</u></th>
    <th>고객명</th>
    <th><u>취미코드</u></th>
    <th>취미명</th>
  </tr>
  <tr>
    <td>1</td>
    <td>홍길동</td>
    <td>01</td>
    <td>영화</td>
  </tr>
  <tr>
    <td>1</td>
    <td>홍길동</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
  <tr>
    <td>2</td>
    <td>임꺽정</td>
    <td>03</td>
    <td>독서</td>
  </tr>
  <tr>
    <td>3</td>
    <td>이순신</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
</table>

결정자를 **고객번호+취미코드** 로 지정하면 결정자에 대해 각 레코드가 **원자성을 확보** 할 수 있음.

## 잘못된 1차 정규화 방법

<table style="text-align:center;">
  <tr>
    <th><u>고객번호</u></th>
    <th>고객명</th>
    <th>취미코드</th>
    <th>취미명</th>
  </tr>
  <tr>
    <td>1</td>
    <td>홍길동</td>
    <td>01</td>
    <td>영화</td>
  </tr>
  <tr>
    <td>1</td>
    <td>홍길동</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
  <tr>
    <td>2</td>
    <td>임꺽정</td>
    <td>03</td>
    <td>독서</td>
  </tr>
  <tr>
    <td>3</td>
    <td>이순신</td>
    <td>02</td>
    <td>바둑</td>
  </tr>
</table>

레코드만 여러 개로 분리함(결정자는 그대로 1개인 상턔) -> 결정자를 **고객번호+취미코드**로 변경해야 함

# 정리

## [1] 1차 정규화의 개요
1. 1차 정규화의 개념
  - '어떤 릴레이션 R에 속한 모든 도메인이 원자 값(Atomic Value)을 구성함'을 의미
2. 1차 정규화 특징
  - 방법 2: 반복되는 속성들에 대해서 별도의 테이블로 분리하여 수행하는 방법
  - '주식별자에 대응되는 레코드가 1개'라는 성질이 원자성(Atomic Value)의 개념임

## [2] 1차 정규화의 유형
1. 1차 정규화를 수행하는 방법 2가지
  - 방법 1: 결정자를 복합속성으로 지정하는 방법
  - 방법 2: 반복되는 속성들에 대해서 별도의 테이블로 분리하여 수행하는 방법 <- 실무에서 자주 씀

## [3] 1차 정규화 사례
- 동일한 테이블 내에서 결정자의 조정 없이 레코드만 분리하여 기술한 것을 1차 정규화가 완료되었다고 하지 않음.